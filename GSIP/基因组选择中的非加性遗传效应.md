# 一、显性基因组关系

**基因替代的平均效应为**:
$$
\alpha=a+d(q-p)
$$

* 基因的“生物学”加性效应$a$
* 显性效应$d$
* 等位基因频率$q和p$

## &#9352;全基因组显性模型

$$
\mathbf{y}=\mathbf{1}\mu+\mathbf{u}+\mathbf{v}+\mathbf{e}
\\
\text{其中，}\mathbf{u}\text{育种值；}\mathbf{v}\text{显性离差}
$$

### &#9312;个体育种值

$$
Z_{ij} =
\begin{cases}
(2 - 2p_j)  \\
(1 - 2p_j) \\
-2p_j 
\end{cases}\text{  for genotype }
\begin{cases}
A_1 A_1 \\
A_1 A_2 \\
A_2 A_2
\end{cases}
$$

* $p$是$A_1$的频率
* 个体育种值为$\mathbf{u}=\mathbf{Z}\alpha$

$$
\sigma_u^2=2pq\alpha^2
\\
E(u)=0
$$

* ==加性方差包含标记加性与显性效应引起的变异==。

### &#9313;显性离差

$$
W_{ij} =
\begin{cases}
-2q_j^2  \\
2p_jq_j  \\
-2p_j^2 
\end{cases}\text{  for genotype }
\begin{cases}
A_1 A_1 \\
A_1 A_2 \\
A_2 A_2
\end{cases}
$$

* ==显性离差包含部分生物学显性效应==
* $\mathbf{v}=\mathbf{Wd}$

$$
E(v)=0
\\
\text{加遗传方差：}\sigma_v^2=[2pqd]^2
\\
\text{显性遗传方差：}\sigma_u^2=2pq\alpha^2
$$

### &#9314;扩展到多个标记

$$
\sigma_u^2=\sum{_{j=1}^{n}(2p_jq_j)\sigma^2_{a0}}+\sum{_{j=1}^{n}(2p_jq_j(q_j-p_j)^2)\sigma^2_{d0}}
\\
\sigma_v^2=\sum{_{j=1}^{n}(2p_jq_j)^2\sigma_{d0}^2}
$$

* 其中$\sigma_{a0}^2$和$\sigma_{d0}^{2}$分别为加性与显性成分的SNP方差
* 总遗传方差为$\sigma_g^2=\sigma_u^2+\sigma_v^2$

$$
Var(\mathbf{u})=\frac{\mathbf{ZZ^`}}{2\sum{_{j=1}^{n}p_jq_j}}\sigma_u^2=\mathbf{G}\sigma_u^2
\\
Var(\mathbf{v})=\mathbf{WW^`}\sigma_{d0}^2
\\
Var(\mathbf{v})=\frac{\mathbf{WW}^`}{\sum{_{j=1}^{n}(2p_jq_j)^2\sigma_{d0}^2}}\sigma^2_u=\mathbf{D}\sigma_v^2
$$

* $\mathbf{D}$为显性基因组关系矩阵

### &#9315;显性基因组关系矩阵

#### &#9332;**对角线元素之和**

$$
\frac{[p^{2}(-2q^{2})^{2} + 2pq(2pq)^{2} + q^{2}(-2p^{2})^{2}]}{(2pq)^{2}}
\\
\text{其中，对于单个基因座，其值等于1}
$$

#### &#9333;**非对角线元素之和**

$$
\left(\begin{array}{lll} p^{2} & 2 p q & q^{2} \end{array}\right)
\left(\begin{array}{rll}
-2 q^{2} & & \\ 
 & 2 p q & \\ 
 & & -2 p^{2}
\end{array}\right)
\left(\begin{array}{l} -2 q^{2} \\ 2 p q \\ -2 p^{2} \end{array}\right)
\left(\begin{array}{lll} p^{2} & 2 p q & q^{2} \end{array}\right)^{\prime}
\\
\text{其中，对于单个基因座，其值等于0}
$$

## &#9353;直观拟合“生物学”效应模型

$$
\mathbf{y}=\mathbf{1}\mu+\mathbf{Ta}+\mathbf{Xd}+\mathbf{e}
\\
\text{其中，包含加性效应}a_{j}\text{和显性效应}d_{j}
\\
t_{ij} =
\begin{cases}
1 \\ 0 \\ -1   \end{cases} \text{for genotype }
\begin{cases}
A_1 A_1 \\
A_1 A_2 \\
A_2 A_2
\end{cases}
 \\
x_{ij} =
\begin{cases}
0  \\
1  \\
0 \end{cases}  \text{  for genotype }
\begin{cases}
A_1 A_1 \\
A_1 A_2 \\
A_2 A_2
\end{cases}
$$

* ”基因型”模型不具备正交性，引入显性效应会**显著改变加性值与方差估计**。
* 所估加性值并非育种值——它们属于”基因型”加性值。

# 二、杂种优势

数量遗传经典理论认为近交衰替（或杂交优势）源于定向显性。

**标准模型**：
$$
\begin{align}
y_i&=\mu+\sum{^{n}_{j=1}t_{ij}a_{j}}+\sum{^n_{j=1}c_{ij}}[d^*_j+\mu_d]+e_i
\\
&=\mu+\sum{^{n}_{j=1}t_{ij}a_{j}}+\sum{^n_{j=1}c_{ij}}d^*_j+\sum{^n_{j=1}c_{ij}}\mu_d+e_i
\end{align}
$$

* 设$d^*_j=d_j-\mu_d$，则$E(d^*)=0$
* $\sum{^n_{j=1}c_{ij}}\mu_d$项表示第$i$个个体显性效应的均值，$c_{ij}$在杂合子位点为1，纯合子位点为$0$。

$$
\text{近交系数：}f_i=1-\frac{\sum{^n_{j=1}c_{ij}}}{n}
$$

# 三、非哈达温伯格平衡下的基因组关系矩阵

**模型正交**：==某个遗传效应的估计不受其他遗传效应存在与否的影响。==

加性($\mathbf{G}$)与显性离差($\mathbf{D}$)关系矩阵的构建可以**摆脱哈达温伯格平衡的要求**，仅需要连锁平衡。
$$
\mathbf{z}_{ij} = 
\begin{cases} 
-(-p_{A_1 A_2} - 2 p_{A_2 A_2}) \\
-(1 - p_{A_1 A_2} - 2 p_{A_2 A_2})  \\
-(2 - p_{A_1 A_2} - 2 p_{A_2 A_2}) 
\end{cases}\text{  for genotype }
\begin{cases}
A_1 A_1 \\
A_1 A_2 \\
A_2 A_2
\end{cases}
\\
\mathbf{w}_{ij} = 
\begin{cases} 
- \dfrac{2 p_{A_1 A_2} p_{A_2 A_2}}{ (p_{A_1 A_1} + p_{A_2 A_2} - (p_{A_1 A_1} - p_{A_2 A_2}) )^2 }  \\
\dfrac{4 p_{A_1 A_1} p_{A_2 A_2}}{ (p_{A_1 A_1} + p_{A_2 A_2} - (p_{A_1 A_1} - p_{A_2 A_2}) )^2 } \\
- \dfrac{2 p_{A_1 A_1} p_{A_1 A_2}}{ (p_{A_1 A_1} + p_{A_2 A_2} - (p_{A_1 A_1} - p_{A_2 A_2}) )^2 } 
\end{cases}\text{  for genotype }
\begin{cases}
A_1 A_1 \\
A_1 A_2 \\
A_2 A_2
\end{cases}
$$

&#931加性关系矩阵
$$
Var(\mathbf{u})=\frac{\mathbf{ZZ^`}}{tr(\mathbf{ZZ^`})/n}\sigma_v^2=\mathbf{G}\sigma_v^2
$$

* 显性离差关系矩阵

$$
Var(\mathbf{v})=\frac{\mathbf{WW^`}}{tr(\mathbf{WW^`})/n}\sigma_v^2=\mathbf{D}\sigma_v^2
$$

* $n$为个体数量

# 四、上位基因组关系

==下面将$\mathbf{Z}$和$\mathbf{W}$分别命名为$\mathbf{H}_a$和$\mathbf{H}_d$，则矩阵$\mathbf{H}_a$具有$n$行（个体数）和$m$列（标记数）。==

> [!IMPORTANT]
>
> 两位点二阶上位效应的关系矩阵系数可通过单一为点数效应关系矩阵的Kronecker积计算。

$$
Var(\mathbf{g}_{AA})=\frac{\mathbf{G}_A\otimes\mathbf{G}_A}{tr(\mathbf{G}_A\otimes\mathbf{G}_A)/n}\sigma_{gAA}^2=\mathbf{G}_{AA}\sigma^2_{gAA}
\\
Var(\mathbf{g}_{DD})=\frac{\mathbf{G}_D\otimes\mathbf{G}_D}{tr(\mathbf{G}_D\otimes\mathbf{G}_D)/n}\sigma_{gDD}^2=\mathbf{G}_{DD}\sigma^2_{gDD}
\\
Var(\mathbf{g}_{AD})=\frac{\mathbf{G}_A\otimes\mathbf{G}_D}{tr(\mathbf{G}_A\otimes\mathbf{G}_D)/n}\sigma_{gAD}^2=\mathbf{G}_{AD}\sigma^2_{gAD}
$$

