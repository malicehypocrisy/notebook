# 一、基因数据

## &#9352;数据格式

* `VCF`
* `BED` - PLINK
* plain text file

## &#9353;基因编码

* 只有基因组关系矩阵与可靠性不同。
* 同一标记内等位基因编码之间的距离是相等的

## &#9354;统计与质检

### &#9312;检出率（call Rate)

* 低检出率与低基因型质量
* 对于Illumina和Affymetrix基因芯片基因型，检出率低于95%应排除

### &#9313;次等位基因频率（MAF）

* 通常等位基因频率过滤值设为`1%`
* 样本量较大，可以设置更低的水平。

### &#9314;杂合率

* 杂合度高于预期表明样本受到污染且基因分型质量较低。
* 与群体平均杂合度偏离3个标准差的样本应该剔除。
* 杂合度过高可以用于去除低质量基因型（**预期值与观测值之间的差异**）

### &#9315;重复样本（SNP）

* 根据等位基因频率对SNP进行排序
* 局部搜索
* 并行处理

### &#9316;孟德尔错误

* 亲代与子代之间基因型的不一致
* 系谱错误
* 样本混淆
* 基因型质量差

### &#9317;哈达温伯格平衡

* 在高强度选育的群体，可能跳过。

# 二、模拟

## &#9352;种群模拟

### &#9312;反向模拟

* 溯祖
* 采用一组当天采样的序列，逆时间回溯，重建共同的祖先序列。

### &#9313;正向模拟

* 基因剔除
* 顺时间向前推演

## &#9353;解决方案

* 简化模型
* 根据当前连锁不平衡信息计算种群大小
* 以相等的等位基因频率或非分离的等位基因开始模拟

### &#9312;步骤

* 模拟创建者/基础种群
* 模拟从奠基者开始的近代世代

### &#9313;模拟多基因效应

* 针对基础群体

$$
a\sim N(0, \sigma^2_a)
\\
a_i = \sigma_a * NRnd
\\NRnd \sim N(0,1)
$$

* 针对近代种群

$$
a_i = \frac{a_{sire}+a_{dam}}{2} + MS_i
\\
MS_i = \sigma_a * NRnd * \sqrt{0.5-0.25(F_{sire}+F_{dam})}
$$

### &#9314;模拟残差效应

* 适用所有群体

$$
e \sim N(0,\sigma^2_e)
\\
e_i = \sigma_e *NRnd
NRnd \sim N(0,1)
$$

### &#9315;模拟标记与QTLs

#### &#9332;针对基础群体（先验/参数）

* 等位基因频率分布
* 等位基因数量
* 遗传结构
* 过去种群统计学事件
* 过去有效种群规模

#### &#9333;奠基者世代

* 模拟足够多是代数，以达到突变-漂变平衡
* 模拟已知的种群事件
* 无选择

#### &#9334;模拟QTL效应

* 在最后一个历史世代模拟数量性状基因座效应
* **QTL等位基因效应**：根据指定分布进行抽样，然后缩放，使最后一个历史世代QTL的综合等于输入的QTL方差。

#### &#9335;针对历史群体中的后代

* 随机抽取两个个体，不考虑性别（配子随机结合）
* 根据二项分布交叉数进行抽样
* 随机放置交叉点
* 随机选择一个单倍体开始，遍历所有单倍型
* ==模拟突变==

&#9336;针对历史世代之后的后代

* 根据交配设计选择已知雄性与雌性
* 根据二项分布对交叉点进行抽样
* 随机放置交叉点
* 随机选择一种单倍体作为起始，然后白能力所有单倍体。

# 三、LD

## &#9352;当单倍型未知

$$
D=\frac{n}{n-1}[\frac{4n_{AABB}+2(n_{AABb}+n_{AaBb})}{2n}-2f_Af_B]
\\
\text{其中，}n\text{个体数量}
\\
\text{D的正负取决与A和B处于偶联相还是互斥相}
$$

## &#9353;对于双等位基因标记

$$
r^2=\frac{D^2}{f_Af_af_Bf_b}
$$

* 使用$D^`$或者$\chi^2$来评估LD

## &#9354;过去有效群体估计

$$
E(r^2)=\frac{1}{1+4Ne*c}
\\ Ne=\frac{1}{2c}
\\
\text{c是摩尔距离}
$$

